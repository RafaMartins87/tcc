--CREATE DATABASE TCC2
--USE TCC2

--TABELAS

CREATE TABLE F_CONSULTAS(
ID_CONSULTA INT NOT NULL,
ID_PACIENTE INT NOT NULL,
ID_DENTISTA INT NOT NULL,
ID_CONVENIO INT NOT NULL,
ID_SERVICO INT NOT NULL,
ID_TRATAMENTO INT NOT NULL,
DT_CONSULTA DATE NOT NULL,
VALOR_CONSULTA DECIMAL(5,2) NOT NULL
)

CREATE TABLE D_PACIENTES(
ID_PACIENTE INT IDENTITY(1,1) NOT NULL,
NM_PAC VARCHAR(30) NOT NULL,
CONVENIO VARCHAR(50) NOT NULL
)

CREATE TABLE D_DENTISTAS(
ID_DENTISTA INT IDENTITY(1,1) NOT NULL,
CRO INT,
EMAIL_DENT VARCHAR(50)
)

CREATE TABLE D_CONVENIOS(
ID_CONVENIO INT IDENTITY(1,1) NOT NULL,
DS_CONV VARCHAR(50)
)

CREATE TABLE D_SERVICOS(
ID_SERVICO INT IDENTITY(1,1) NOT NULL,
DS_SERV VARCHAR(100),
)

--PKs
ALTER TABLE F_CONSULTAS
ADD CONSTRAINT PK_CONSULTA PRIMARY KEY(ID_CONSULTA)

ALTER TABLE D_PACIENTES
ADD CONSTRAINT PK_PACIENTE PRIMARY KEY(ID_PACIENTE)

ALTER TABLE D_DENTISTAS
ADD CONSTRAINT PK_DENTISTA PRIMARY KEY(ID_DENTISTA)

ALTER TABLE D_CONVENIOS
ADD CONSTRAINT PK_CONVENIO PRIMARY KEY(ID_CONVENIO)

ALTER TABLE D_SERVICOS
ADD CONSTRAINT PK_SERVICO PRIMARY KEY(ID_SERVICO)

--FKs
ALTER TABLE F_CONSULTAS
ADD CONSTRAINT FK_PACIENTE FOREIGN KEY (ID_PACIENTE) REFERENCES D_PACIENTES (ID_PACIENTE)

ALTER TABLE F_CONSULTAS
ADD CONSTRAINT FK_DENTISTA FOREIGN KEY (ID_DENTISTA) REFERENCES D_DENTISTAS (ID_DENTISTA)

ALTER TABLE F_CONSULTAS
ADD CONSTRAINT FK_CONVENIO FOREIGN KEY (ID_CONVENIO) REFERENCES D_CONVENIOS (ID_CONVENIO)

ALTER TABLE F_CONSULTAS
ADD CONSTRAINT FK_SERVICO FOREIGN KEY (ID_SERVICO) REFERENCES D_SERVICOS (ID_SERVICO)

--MASSA DE DADOS

INSERT INTO D_CONVENIOS VALUES ('AMIL DENTAL')
select * from D_CONVENIOS

INSERT INTO D_DENTISTAS(CRO,EMAIL_DENT) VALUES(27537,'CONSULTORIO_DRA.SUZY@HOTMAIL.COM')

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('DANIELA DE SOUZA M DA SILVA','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('CLAUDINA DOS SANTOS DO ROSARIO','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('LARISSA MORAES ALCANTARA','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('RENAN LEANDRO DE ROSSI','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('SARAH DE JESUS MENDES','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('VANESSA PEDROSO DE ALCANTARA','AMIL DENTAL')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('SAMUEL VIEIRA OLIVEIRA','AMIL DENTAL')

SELECT * FROM D_PACIENTES

INSERT INTO D_SERVICOS VALUES('RADIOGRAFIA PERIAPICAL')
INSERT INTO D_SERVICOS VALUES('EXODONTIA DE RAIZ RESIDUAL')
INSERT INTO D_SERVICOS VALUES('CONSULTA ODONTOLOGIA')
INSERT INTO D_SERVICOS VALUES('LIMPEZA')
INSERT INTO D_SERVICOS VALUES('RESTAURACAO EM RESINA')
INSERT INTO D_SERVICOS VALUES('EXODONTIA SIMPLES DE DECIDUO')

SELECT * FROM D_SERVICOS

ALTER TABLE F_CONSULTAS
DROP CONSTRAINT FK_PACIENTE

ALTER TABLE F_CONSULTAS
DROP COLUMN ID_PACIENTE

ALTER TABLE F_CONSULTAS
ADD ID_PACIENTE INT

ALTER TABLE F_CONSULTAS
ADD CONSTRAINT FK_PACIENTE FOREIGN KEY (ID_PACIENTE) REFERENCES D_PACIENTES (ID_PACIENTE)

SELECT * FROM F_CONSULTAS
/*
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(1,1,1,1,'20180221',5.2)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(2,1,1,2,'20180403',31.41)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(3,1,1,3,'20180403',19.34)


INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(4,1,1,4,'20180403',12.31)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(5,1,1,4,'20180403',12.31)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(6,1,1,4,'20180403',12.31)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(7,1,1,4,'20180403',12.31)*/

SELECT * FROM D_SERVICOS

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(8,1,1,1,'20180430',5.2)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(9,1,1,3,'20180404',8.98)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(10,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(11,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(12,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(13,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(14,1,1,3,'20171219',19.34)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(15,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(16,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(17,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(18,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(20,1,1,5,'20180317',31.89)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(21,1,1,5,'20180317',31.89)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(22,1,1,5,'20180328',28.21)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(23,1,1,5,'20180328',28.21)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(24,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(25,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(26,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(27,1,1,4,'20180430',12.31)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(28,1,1,6,'20180112',19.98)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(29,1,1,3,'20180404',8.98)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(30,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(31,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(32,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(33,1,1,4,'20180502',14.97)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(34,1,1,2,'20180519',31.41)--

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(34,1,1,2,'20180519',31.41)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('ENZO PABLO LIBERATO GUTIERREZ','METLIFE')
INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('IVANETE DA SILVA NASCIMENTO','METLIFE')

INSERT INTO D_SERVICOS VALUES('PROFILAXIA: POLIMENTO CORONÁRIO')

INSERT INTO D_CONVENIOS VALUES ('METLIFE')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA ) 
VALUES(35,1,2,7,'20180524',11.55)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(36,1,2,7,'20180524',11.55,9)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(37,1,2,5,'20180605',17.71,9)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(38,1,2,3,'20180526',9.24,9)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(39,1,2,8,'20180529',26.18,9)

INSERT INTO D_SERVICOS VALUES ('RASPAGEM SUPRA-GENGIVAL')

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('ANDERSON DA SILVA','METLIFE')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(40,1,2,3,'20180526',9.24,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(41,1,2,5,'20180526',17.71,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(42,1,2,5,'20180526',17.71,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(43,1,2,5,'20180526',23.87,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(44,1,2,5,'20180526',23.87,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(45,1,2,5,'20180526',17.71,10)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(46,1,2,8,'20180526',26.18,10)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(47,1,2,6,'20180605',18.48,10)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(48,1,2,5,'20180523',25.41,12)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('HELENILZA M. DE OLIVEIRA FILHA','METLIFE')

INSERT INTO D_CONVENIOS VALUES ('UNIMED')

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('LARISSA PEREIRA MONTEIRO','UNIMED')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(49,1,3,3,'20180519',9.54,13)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(50,1,3,5,'20180530',29.68,13)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('ANA CLAUDIA M. DO NASCIMENTO','UNIMED')

INSERT INTO D_SERVICOS VALUES ('PACOTE PERIODONTAL BASICO')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(51,1,3,3,'20180530',9.54,15)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(52,1,3,9,'20180517',42.40,13)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(53,1,3,5,'20180508',25.44,15)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('ROBERTO FERREIRA A. JUNIOR','UNIMED')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(54,1,3,3,'20180503',9.54,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(55,1,3,5,'20180510',29.68,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(56,1,3,5,'20180517',29.68,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(57,1,3,5,'20180517',25.44,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(58,1,3,5,'20180510',25.44,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(59,1,3,5,'20180517',25.44,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(60,1,3,1,'20180503',4.77,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(61,1,3,1,'20180503',4.77,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(62,1,3,1,'20180503',4.77,16)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(63,1,3,1,'20180503',4.77,16)

INSERT INTO D_CONVENIOS VALUES ('INTERODONTO')

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('KLISMMAN VILLAR DA SILVA','INTERODONTO')

INSERT INTO D_SERVICOS VALUES ('ATIVIDADE EDUCATIVA')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(64,1,4,3,'20180526',6.10,17)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(65,1,4,10,'20180526',21.66,17)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('MELISSA DA CONCEICAO','INTERODONTO')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(66,1,4,3,'20180526',6.10,17)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(67,1,4,8,'20180526',19.22,17)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(68,1,4,8,'20180526',19.22,17)

UPDATE F_CONSULTAS
SET ID_PACIENTE = 18 
WHERE ID_CONSULTA = 68

--SELECT PARA NOME DO PACIENTE E O SERVIÇO QUE REALIZOU
SELECT ID_CONSULTA, NM_PAC, DS_SERV FROM	F_CONSULTAS C 
INNER JOIN									D_PACIENTES P ON P.ID_PACIENTE = C.ID_PACIENTE
INNER JOIN									D_SERVICOS S ON C.ID_SERVICO = S.ID_SERVICO

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(69,1,1,3,'20180403',19.34,2)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(70,1,1,4,'20180403',12.31,2)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(71,1,1,4,'20180403',12.31,2)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(72,1,1,4,'20180403',12.31,2)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(73,1,1,4,'20180403',12.31,2)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('FRANCISCA BORGES DE ARAUJO','AMIL')

INSERT INTO D_SERVICOS VALUES ('EXODONTIA SIMPLES DE PERMANENTE')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(74,1,1,3,'20180503',19.34,19)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(75,1,1,11,'20180503',34.52,19)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(76,1,1,11,'20180503',34.52,19)

INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('FERNANDA RITA DO NASCIMENTO','AMIL')

INSERT INTO D_SERVICOS VALUES ('TRAT. ENDODONTICO BIRRADICULAR')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(77,1,1,12,'20180315',115.35,20)

-- VERIFICAÇÃO DE EXISTÊNCIA DE OBJETO
if exists(select 1 from syscolumns where id = object_id('D_PACIENTES') and name = 'JUNIOR ALMEIDA DA ROCHA')
   print 'Existe Objeto'
else
   print 'Não existe Objeto'  
   PRINT 'INSERINDO'
   INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('JUNIOR ALMEIDA DA ROCHA','AMIL')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(78,1,1,3,'20180404',19.34,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(79,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(80,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(81,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(82,1,1,4,'20180404',12.31,21)

if exists(select 1 from syscolumns where id = object_id('D_PACIENTES') and name = 'LARISSA MORAES ALCANTARA')
   print 'EXISTE OBJETO'
else
   print 'NÃO EXISTE OBJETO'  
   PRINT 'INSERINDO'
   INSERT INTO D_PACIENTES(NM_PAC,CONVENIO) VALUES('LARISSA MORAES ALCANTARA','AMIL')
    
UPDATE D_PACIENTES
SET CONVENIO = 'AMIL DENTAL'
WHERE CONVENIO = 'AMIL'

if exists(select 1 from syscolumns where id = object_id('D_SERVICOS') and name = 'TRAT. ENDODONTICO MULTIRRADICULAR')
   print 'EXISTE OBJETO'
else
   print 'NÃO EXISTE OBJETO'  
   PRINT 'INSERINDO'
   INSERT INTO D_SERVICOS VALUES('TRAT. ENDODONTICO MULTIRRADICULAR')

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(83,1,1,3,'20180706',19.08,22)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(84,1,1,4,'20180713',12.14,22)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(85,1,1,4,'20180713',12.14,22)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(86,1,1,4,'20180713',12.14,22)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(87,1,1,4,'20180713',12.14,22)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(88,1,1,13,'20180713',173.66,22)

INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(89,1,1,3,'20180404',19.34,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(90,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(91,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(92,1,1,4,'20180404',12.31,21)
INSERT INTO F_CONSULTAS (ID_CONSULTA, ID_DENTISTA, ID_CONVENIO, ID_SERVICO, DT_CONSULTA,VALOR_CONSULTA, ID_PACIENTE) 
VALUES(93,1,1,4,'20180404',12.31,21)



